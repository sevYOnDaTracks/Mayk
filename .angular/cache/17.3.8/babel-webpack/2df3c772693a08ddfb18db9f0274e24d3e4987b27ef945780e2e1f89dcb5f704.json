{"ast":null,"code":"import _asyncToGenerator from \"/Users/sevyondatracks/Downloads/dexamhtml-300/dexamhtml-300/dexam-angular-landing-page/dexam-angular/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { FormBuilder, Validators } from '@angular/forms';\nimport { AdmissionService } from '../../services/admission.service';\nimport { AngularFireStorage } from '@angular/fire/compat/storage';\nimport { finalize } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nimport * as i2 from \"../../services/admission.service\";\nimport * as i3 from \"@angular/fire/compat/storage\";\n// ... (other imports)\nexport let AdmissionComponent = /*#__PURE__*/(() => {\n  class AdmissionComponent {\n    constructor(fb, admissionService, storage) {\n      this.fb = fb;\n      this.admissionService = admissionService;\n      this.storage = storage;\n      this.degreeLevels = ['Bac+0', 'Bac+1', 'Bac+2', 'Bac+3', 'Bac+4', 'Bac+5'];\n      this.admissionForm = this.fb.group({\n        userId: ['', Validators.required],\n        degreeLevel: ['', Validators.required],\n        documents: this.fb.array([])\n      });\n    }\n    get documents() {\n      return this.admissionForm.get('documents');\n    }\n    addDocument(level) {\n      const documentForm = this.fb.group({\n        level: [level],\n        description: [''],\n        average: [0],\n        files: this.fb.array([])\n      });\n      this.documents.push(documentForm);\n    }\n    addFile(documentIndex) {\n      const fileForm = this.fb.group({\n        description: [''],\n        url: ['']\n      });\n      this.documents.at(documentIndex).get('files').push(fileForm);\n    }\n    uploadFile(event, documentIndex, fileIndex) {\n      var _this = this;\n      return _asyncToGenerator(function* () {\n        const file = event.target.files[0];\n        if (!file) {\n          return; // Handle no file selected case\n        }\n        const filePath = `documents/${file.name}`;\n        const fileRef = _this.storage.ref(filePath);\n        const task = _this.storage.upload(filePath, file);\n        try {\n          yield task.snapshotChanges().pipe(finalize(() => {\n            fileRef.getDownloadURL().subscribe(url => {\n              _this.documents.at(documentIndex).get('files').at(fileIndex).patchValue({\n                url\n              });\n            });\n          })).toPromise();\n        } catch (error) {\n          console.error('Error uploading file:', error);\n          // Handle upload errors\n        }\n      })();\n    }\n    onSubmit() {\n      if (this.admissionForm.valid) {\n        this.admissionService.createAdmission(this.admissionForm.value).then(() => {\n          console.log('Admission submitted successfully');\n        });\n      }\n    }\n    ngOnInit() {}\n    static #_ = this.ɵfac = function AdmissionComponent_Factory(t) {\n      return new (t || AdmissionComponent)(i0.ɵɵdirectiveInject(i1.FormBuilder), i0.ɵɵdirectiveInject(i2.AdmissionService), i0.ɵɵdirectiveInject(i3.AngularFireStorage));\n    };\n    static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: AdmissionComponent,\n      selectors: [[\"app-admission\"]],\n      decls: 0,\n      vars: 0,\n      template: function AdmissionComponent_Template(rf, ctx) {},\n      styles: [\"mat-form-field[_ngcontent-%COMP%]{width:100%;margin-bottom:15px}input[type=file][_ngcontent-%COMP%]{margin-bottom:15px}\"]\n    });\n  }\n  return AdmissionComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}